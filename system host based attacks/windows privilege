windows
windowsの脆弱性の概要
・windowsは、世界的に支配的なOSであり、広く利用されているため攻撃の格好の的になりやすい。
・過去15年間でWindowsは深刻な脆弱性を抱えてきた。
・windowsの脆弱性には、数多くのエクスプロイトコードが存在する。

・windowsには、多様なバージョンやリリースが存在し、これにより脆弱性の観点で脅威の範囲が断片化している。
・バージョンやリリースが異なっても、全てのwindowsOSには共通点がある
1) windowsOSは、C言語で開発されているので、バッファーオーバーフローや任意コード実行の脆弱性に晒されやすい
2) windowsを安全に動作させるために自分で積極的にセキュリティ対策を講じる必要がある
3) 新たなに発見された脆弱性はパッチが適用されていないことも多く、windowsの断片化により多くのものが未修正のまま残されている

・windowsの新バージョンの頻繁なリリースも脆弱性悪用に一因である。
→理由は、大企業では、アップデートまでに時間がかかる
・固有の脆弱性に加えて、windowsにはクロスプラットフォームの脆弱性も存在する
→SQLインジェクション攻撃が該当する。

＊クロスプラットフォーム：異なるOSやデバイスで同じアプリケーションを動作させることを可能にする技術や考え方

・windowsを実行しているシステムやホストは物理的な攻撃にも脆弱
→盗難や悪意のある周辺機器の接続などが挙げられる

windowsの脆弱性の悪用
1) 情報漏洩：攻撃者が機密データへアクセスできるようにする脆弱性
2) バッファーオーバーフロー：プログラムのエラーが原因で、攻撃者がバッファー領域にデータを書き込み、割り当てられた範囲を超えてメモリ領域にデータを書き込むことができる脆弱性
3) リモートコードの実行：攻撃者がターゲットシステム上でリモートからコードを実行できるようにする脆弱性
4) 権限昇格：攻撃者が初期侵入後に自らの権限を管理者レベルに引き上げることを可能にする脆弱性
5) サービス拒否(DoS)：攻撃者がシステム/ホストのリソースを大量に消費させ、システムが正常に動作できなくなる脆弱性

頻繁に悪用されるwindowsサービス
・microsoft windowsには、ホスト上で実行可能なさまざまなネイティブサービスやプロトコルがあります。
・これらのサービスは、攻撃者にとってターゲットホストへアクセスするための攻撃ベクトルを提供する
・サービスが何であるか、どのように動作するか、どのような脆弱性があるかを把握することが重要である。

・以下が頻繁に悪用されるサービス名とポート番号と用途である
プロトコル/サービス　　　　　　　　　　　　ポート番号(tcp port)　　　　　　　　　　　目的
Microsoft IIS                          80/443　　　　　　　　　　　Microsoftが開発したWindows上で動作する専用のWebサーバソフトウェア

webdav                                 80/443　　　　　　　　　　　クライアントがWebサーバ上のファイルを更新・移動・コピーできるようにするHTTP拡張機能
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　webdavはWebサーバをファイルサーバとして動作させるために使用する
SMB/CIFS                               445　　　　　　　　　　　　　ローカルネットワーク内のコンピュータ間でファイルや周辺機器を共有するためのネットワーク共有プロトコル
RDP                                    3389　　　　　　　　　　　　Microsoftが開発したGUIベースのリモートアクセスプロトコル
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　Windowsシステムへのリモート認証と操作に使用される
WinRM                                  5986/443　　　　　　　　　　Windowsシステムへのリモートアクセスやリモート管理を行うためのプロトコル


windows権限昇格
windowsカーネルエクスプロイト
・権限昇格とは、システム内の脆弱性や設定ミスを悪用して、あるユーザから別のユーザへ権限を引き上げるプロセスを指す
・権限昇格は、ペンテス全体の成功を左右する主要な要因である
・ターゲットシステムに最初の侵入を確立したあと、管理者権限を必要とするタスクや機能を実行するために、権限を昇格させる必要がある
・権限昇格は、優れたペンテスターになるために重要な証である、。

・windowsカーネルとは、OSの中核をなすコンピュータプログラムであり、システム上の全てのリソースやハードウェアを完全に制御する。
・windowsカーネルは、ハードウェアとソフトウェアの間の「翻訳レイヤー」として機能し、両者の通信を仲介する
・WindowsNTは、全てのmicrosoft windowsのバージョンにあらかじめ組み込まれているカーネルであり、基本的には伝統的なカーネルとして動作する
・WindowsNTカーネルは、システムリソースやハードウェアへのアクセスを決定する2つの主要な動作モードを持っている
1) ユーザモード：ユーザモードで実行されるプログラムやサービスは、システムリソースや機能へのアクセスが制限されている。
2) カーネルモード：カーネルモードでは、システムリソースや機能に無制限アクセスが可能であり、デバイスやメモリの管理などの追加機能も持つ。

・windowsカーネルエクスプロイトは、通常windowsカーネル内の脆弱性を狙い、任意のコードを実行することで特権システムコマンドを実行したり、systemシェルを取得することが目的
・このプロセスは、対象となるwindowsのバージョンや使用するカーネルエクスプロイトの種類によって異なる
・windowsシステムにおける権限昇格は、以下の手順で行う
1) カーネルの脆弱性の特定
2) カーネルエクスプロイトをダウンロード、コンパイル、ターゲットシステムへの転送

demo
1) 

















