攻撃の概要
ホストベース
システム/ホストベースの攻撃
・システム/ホストベースの攻撃とは、特定のOSを実行している特定のシステムやホストを標的にする攻撃。
・ネットワークサービス以外にもペンテスで狙う攻撃ベクトルになる。
・システム/ホストベースの攻撃は通常、ターゲットのネットワークにアクセスを得た後に用いる。
・システム/ホストベースの攻撃は、主にターゲットOSに内在する脆弱性を悪用することに焦点を当てている。
・システム/ホストベースの攻撃は、ネットワーク攻撃よりも専門的で、ターゲットのOSとそれへの影響を理解する必要がある。
・システム/ホストベースの攻撃は、ターゲットOS内の設定ミスや内在する脆弱性を悪用することを含む

windows
windowsの脆弱性
windowsの脆弱性の悪用
・windowsの脆弱性の種類
1) 情報開示：機密データへ攻撃者がアクセスできてしまう脆弱性
2) バッファーオーバーフロー：プログラミングの誤りによりバッファーに過剰なデータを書き込み、割り当てられたメモリアドレスを上書きしてしまう脆弱性
3) リモートコードの実行：攻撃者がターゲット上でリモートに任意のコードを実行できてしまう
4) 権限昇格：初期侵入後に攻撃者がより高い権限を取得できてしまう脆弱性
5) サービス拒否：攻撃者がシステムのリソースを枯渇させ、正常な動作を妨げる脆弱性

Metasploitを使用したwebdavのエクスプロイト
demo

PsExecを使ったSMBのエクスプロイト
・SMB(Server Message Block)は、ローカルネットワーク上のコンピュータ間でファイルや周辺機器を共有するために使用されるネットワーク共有プロトコル
→SMBはポート445
・SAMBAは、SMBのオープンソース実装で、WindowsシステムがLinuxの共有やデバイスにアクセスできるようにする。

・SMBプロトコルでは、2段階で認証を行う
1) ユーザー認証：ユーザーは共有にアクセスするために、SMBサーバーへ認証するときにユーザー名とパスコードを提供する必要がある
2) 共有認証：制限付きの共有にアクセスするために、ユーザーはパスワードを提供する

・PsExecは、Microsoftが開発した軽量のtelnetの代替ツールで、任意のユーザ資格情報を使ってリモートwindowsシステム上でプロセスを実行できる。
→PsExecの認証は、SMB経由で行う
→PsExecユーティリティを使うとターゲットシステムに正当な資格情報で認証して任意のコマンドを実行したり、、リモートのコマンドプロンプトを起動したりする
→RDPに似ているが、GUIでリモート操作する代わりにCMD経由でプロセスを実行するという点が異なる

・PsExecを利用してWindowsのターゲットにアクセスするためには、正当なユーザアカウントとそのパスコードまたはパスワードハッシュを特定する必要がある
・これはさまざまな手法を利用できるが、最も一般的なのは、ブルートフォース攻撃である
・ブルートフォースの対象は、一般的なwindowsユーザアカウントのみに絞る
・資格情報を得た後、それを使ってPsExec経由でターゲットに認証し、任意のシステムコマンドを実行したりリバースシェルを取得したりすることが可能。
